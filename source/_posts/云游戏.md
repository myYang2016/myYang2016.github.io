---
title: 云游戏
date: 2022-02-19 15:15:33
tags:
---
### 云游戏
> 认识一下云游戏。[参考文档](https://www-file.huawei.com/-/media/corporate/pdf/ilab/2019/cloud_game_whitepaper.pdf)

#### 一、什么是云游戏
将游戏上云，就是在供应商提供的云服务器上运行游戏，负责游戏渲染、存储、计算，然后再把渲染结果传到用户屏幕，从而降低对玩家硬件的要求。另一方面，上云后可以实现边缘计算，从而降低游戏的互动延时，提升游戏体验。

在云游戏中，终端只需要负责解码收到的视频流以及发送玩家操作的指令。

#### 二、技术实现
##### 1、云端处理
云游戏服务器解决方案有两种，有虚拟机和物理机。虚拟机由专业的显卡等硬件组合，通过集群统一调度管理资源。物理机有PC农场提供的物理机，其中利用无盘化，即将存储和计算分开，从而提高了资源的利用率。每个玩家都有独立的进程去计算和保存玩家数据，而游戏初始数据可以共享。

##### 2、云端屏幕像素实时抓取
有多种技术方案去抓取屏幕像素。如下所示：
![2c439b1de326deee22d23eda467fe2b2.png](evernotecid://4DB8DB53-1814-4A14-B958-C27969DAC6E3/appyinxiangcom/10748170/ENResource/p406)

##### 3、云端视频编码
视频编码标准一般有H264和H265。H265优化了相关算法。编码分为软编码和硬编码。软编码利用CPU进行编码，优点是质量好，缺点是速度慢。硬编码使用GPU进行，加上专门的编码硬件，可以保证速度和质量都比较高。在云游戏中，由于对时延要求高，一般使用硬编码。

无B编码。编码分为帧内编码帧I、预测编码帧P，双向预测编码帧B。云游戏为了快速，使用了无B编码。

##### 4、推流
使用QUIC协议，在UDP的基础上，拥有CPU的优点，增加了数据冗余，能在丢包时恢复数据，从而解决UDP容易丢包的问题。

##### 5、传输
使用全光网络，即光变为电，电变为光，这两个流程只在推流端和终端进行，中奖部分全部由光去传输，从而提高传输效率。终端使用最新的wifi-6技术，能大幅度加快网络接受。

##### 6、视频解码
解码也分为软解码和硬解码，一般使用硬解码。

#### 三、体验和指标
因为云游戏比本地游戏多了云端抓屏、编码、网络传输、解码等流程，导致出现了延时和画面影响。所以流程的任何一个环节出问题都会影响到游戏体验。
玩家对游戏画面的要求，帧率需要达到60以上。对延时专业玩家需求10ms一下。网络抖动也会造成在帧率达到要求的情况下，出现丢帧的情况，也是影响游戏体验的因素。



