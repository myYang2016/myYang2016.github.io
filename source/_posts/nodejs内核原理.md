---
title: nodejs内核原理
date: 2023-02-13 15:14:32
tags:
---
### nodejs内核原理
> 这是书籍《Node.js设计模式》的读书笔记。

#### 一、nodejs遵循的设计原则
设计原则影响了每个技术栈的特点。nodejs有一下设计原则：
* 短小精悍（便于理解和维护）
* 提供的模块尽量不去扩展功能，且功能越简单越好（防止模块越变越大，如果需要新增功能）

#### 二、事件循环
io操作，就是需要电脑做一些任务，这些任务单单本机的cpu是无法独立完成的，需要cpu和其他外接设备或者网络一起完成。所以，io操作比一般的cpu计算要慢。如果io操作是同步的，即每次io操作都要等待完成，就会容易造成等待时间长，最后导致运行缓慢。一般的解决方案是把io操作放到线程去完成。但是在线程中，由于需要等待io操作完成，导致线程很多时候处于闲置等待状态，而且线程也会占据cpu和内存，所以一个io操作对应一个线程也是不可取的。nodejs采用的是，在一个线程中管理多个io操作（多路复用），并且利用回调来作为io操作结果的响应（解多路复用），从而减少了内存和cpu的占用。

事件循环，即将所有的io操作都放到数组中，利用不同系统的事件分离管理机制，不断循环等待io操作的处理情况，完成的话就可以通过回调返回结果。

#### 三、nodejs的核心模块
* libuv，实现事件循环机制，能兼容各个平台的事件分离管理机制的差异。
* javascript基础功能库
* v8引擎，让nodejs能使用js和c++
